# Prompt Organizacional: Mapeamento de Frames Figma - Projeto IRIS (PRISM)

## Contexto do Projeto

Voc√™ est√° auxiliando no desenvolvimento do **IRIS** (Interface de Pesquisa Interoper√°vel Segura), a implementa√ß√£o pr√°tica do **PRISM - Padr√£o de R√≥tulos e Interfaces para Sistemas M√©dicos**. O PRISM √© um trabalho de conclus√£o de curso (TCC) de Engenharia de Computa√ß√£o da UTFPR que prop√µe uma solu√ß√£o para fragmenta√ß√£o e falta de interoperabilidade em dados biom√©dicos.

### Componentes do PRISM

- **NPI (N√≥ de Pesquisa Integrada)**: Sistema backend que gerencia autentica√ß√£o, armazenamento, valida√ß√£o e acesso aos dados biom√©dicos. Atua como middleware/orquestrador da rede.
- **IRIS**: Interface frontend respons√°vel pela gest√£o de acessos, gest√£o de pacientes e visualiza√ß√£o de dados de pesquisa biom√©dica.
- **Redu√ß√£o Conceitual**: O PRISM agrupa componentes em dois elementos b√°sicos:
  - **Dispositivo** (losangos): Sistemas embarcados de captura de biossinais
  - **Aplica√ß√£o** (c√≠rculos): Sistemas que adicionam contexto e processamento

### Arquitetura do Sistema

```
Bioteca.Prism.InteroperableResearchNode/  (Backend - ASP.NET Core)
‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îî‚îÄ‚îÄ Node/
‚îú‚îÄ‚îÄ Services/
‚îÇ   ‚îî‚îÄ‚îÄ Node/
‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îî‚îÄ‚îÄ Node/
‚îî‚îÄ‚îÄ ...

IRIS/  (Frontend - React/Next.js)
‚îú‚îÄ‚îÄ components/
‚îú‚îÄ‚îÄ pages/
‚îú‚îÄ‚îÄ styles/
‚îî‚îÄ‚îÄ ...
```

## Sua Miss√£o

Automatizar o processo completo de **documenta√ß√£o, mapeamento e especifica√ß√£o** de interfaces do Figma para desenvolvimento do frontend IRIS, utilizando:

1. **MCP Playwright**: Navega√ß√£o automatizada, identifica√ß√£o de frames e captura de screenshots
2. **MCP Figma**: Extra√ß√£o de metadata, estrutura de componentes e c√≥digo UI

## Objetivos

1. **Mapear sistematicamente** todos os frames de uma p√°gina Figma do projeto IRIS
2. **Capturar screenshots** de alta qualidade de cada frame identificado
3. **Documentar estruturadamente** em arquivos Markdown seguindo padr√µes acad√™micos
4. **Extrair links de sele√ß√£o** (fileKey + nodeId) para posterior recupera√ß√£o via MCP Figma
5. **Preparar especifica√ß√µes t√©cnicas** completas para implementa√ß√£o frontend

## Ferramentas Dispon√≠veis

### MCP Playwright
- **Navega√ß√£o web automatizada**: Abrir URLs, interagir com elementos DOM
- **Identifica√ß√£o de frames**: Mapear estrutura do canvas Figma
- **Captura de screenshots**: Imagens de alta qualidade de elementos espec√≠ficos
- **Extra√ß√£o de dados**: Nomes, dimens√µes, posi√ß√µes e node-ids de frames

### MCP Figma
- **`Figma:get_metadata`**: Obt√©m estrutura hier√°rquica em XML (node IDs, tipos, nomes, posi√ß√µes)
- **`Figma:get_screenshot`**: Gera screenshot oficial de um node espec√≠fico
- **`Figma:get_design_context`**: Recupera c√≥digo UI e URLs de assets
- **Parsing de URLs**: Extra√ß√£o autom√°tica de fileKey e nodeId

## Estrutura de Diret√≥rios do IRIS

Com base na documenta√ß√£o do projeto, recomendo a seguinte estrutura:

```
docs/
‚îú‚îÄ‚îÄ architecture/              # Arquitetura e decis√µes t√©cnicas
‚îÇ   ‚îú‚îÄ‚îÄ node-communication.md
‚îÇ   ‚îú‚îÄ‚îÄ handshake-protocol.md
‚îÇ   ‚îî‚îÄ‚îÄ session-management.md
‚îú‚îÄ‚îÄ development/              # Guias de desenvolvimento
‚îÇ   ‚îú‚îÄ‚îÄ ai-assisted-development.md
‚îÇ   ‚îî‚îÄ‚îÄ implementation-roadmap.md
‚îî‚îÄ‚îÄ figma/                    # üÜï Documenta√ß√£o de UI (sua cria√ß√£o)
    ‚îú‚îÄ‚îÄ frames-map.md         # √çndice geral de frames
    ‚îú‚îÄ‚îÄ screens/              # Screenshots dos frames
    ‚îÇ   ‚îú‚îÄ‚îÄ frame-001.png
    ‚îÇ   ‚îú‚îÄ‚îÄ frame-002.png
    ‚îÇ   ‚îî‚îÄ‚îÄ ...
    ‚îî‚îÄ‚îÄ specs/                # Especifica√ß√µes detalhadas
        ‚îú‚îÄ‚îÄ frame-001-spec.md
        ‚îú‚îÄ‚îÄ frame-002-spec.md
        ‚îî‚îÄ‚îÄ ...
```

**Localiza√ß√£o recomendada**: `docs/figma/` dentro do projeto principal.

## Workflow de Execu√ß√£o

### Fase 1: Descoberta e Mapeamento (Playwright)

**Entrada**: URL do Figma (ex: `https://figma.com/design/{fileKey}/{fileName}?node-id=0:1`)

**Processo**:
1. **Validar URL**: Extrair `fileKey` do formato padr√£o Figma, caso seja muito grande, acesse pelo Playwright MCP diretamente na p√°gina do figma
2. **Navegar com Playwright**: Abrir p√°gina (assumir autentica√ß√£o pr√©via)
3. **Identificar frames top-level**: Varrer o canvas e localizar todos os frames principais
4. **Extrair metadados** de cada frame:
   - Nome do frame
   - Dimens√µes (largura x altura)
   - Posi√ß√£o (x, y)
   - `node-id` obtido da URL quando frame est√° selecionado
5. **Capturar screenshots**:
   - Selecionar frame programaticamente
   - Tirar screenshot em alta resolu√ß√£o (2x para Retina)
   - Salvar como `docs/figma/screens/frame-{id:03d}.png`

**Sa√≠da**: Conjunto de screenshots + dados estruturados de cada frame

---

### Fase 2: Documenta√ß√£o Estruturada

#### 2.1 Gerar `frames-map.md`

Criar √≠ndice geral seguindo o template:

```markdown
# Mapa de Frames - IRIS (PRISM)

Documenta√ß√£o autom√°tica dos frames do Figma para o projeto IRIS - Interface de Pesquisa Interoper√°vel Segura.

**Arquivo Figma**: [IRIS UI Design](URL_completa)  
**Data de Mapeamento**: 2025-10-17 15:30  
**Total de Frames**: 12  
**Status Geral**: üî¥ 0% implementado

---

## √çndice de Frames

| ID  | Nome do Frame          | Dimens√µes  | M√≥dulo NPI | Status          | Especifica√ß√£o                    |
|-----|------------------------|------------|------------|-----------------|----------------------------------|
| 001 | Login Screen           | 1440x900   | Auth       | üî¥ N√£o iniciado | [Ver spec](specs/frame-001-spec.md) |
| 002 | Dashboard Principal    | 1920x1080  | Dashboard  | üî¥ N√£o iniciado | [Ver spec](specs/frame-002-spec.md) |
| 003 | Cadastro de Pacientes  | 1920x1080  | Patients   | üî¥ N√£o iniciado | [Ver spec](specs/frame-003-spec.md) |
| 004 | Gest√£o de Acessos      | 1920x1080  | Auth       | üî¥ N√£o iniciado | [Ver spec](specs/frame-004-spec.md) |

---

## Frames Detalhados

### Frame 001: Login Screen

![Screenshot](screens/frame-001.png)

**URL Figma**: `https://figma.com/design/{fileKey}/{fileName}?node-id={nodeId}`  
**M√≥dulo PRISM**: Autentica√ß√£o e Identifica√ß√£o (NPI)  
**Tipo**: Tela de entrada do sistema  
**Prioridade**: üî¥ Alta  
**Tags**: `#auth`, `#login`, `#seguran√ßa`, `#NPI`

**Descri√ß√£o**:  
Interface de autentica√ß√£o para acesso ao IRIS. Implementa os requisitos de seguran√ßa definidos no PRISM para identifica√ß√£o de usu√°rios (pesquisadores, profissionais de sa√∫de) que acessar√£o o NPI.

---

### Frame 002: Dashboard Principal

![Screenshot](screens/frame-002.png)

**URL Figma**: `https://figma.com/design/{fileKey}/{fileName}?node-id={nodeId}`  
**M√≥dulo PRISM**: Visualiza√ß√£o de Dados (Aplica√ß√£o)  
**Tipo**: Tela principal de visualiza√ß√£o  
**Prioridade**: üî¥ Alta  
**Tags**: `#dashboard`, `#overview`, `#biossinais`, `#visualiza√ß√£o`

**Descri√ß√£o**:  
Painel principal do IRIS que apresenta vis√£o geral dos projetos de pesquisa, dados de biossinais capturados e status das integra√ß√µes com dispositivos.

---

[... continuar para todos os frames ...]
```

#### 2.2 Gerar Especifica√ß√µes Individuais (`frame-{id}-spec.md`)

Para cada frame, criar arquivo detalhado:

```markdown
# Especifica√ß√£o T√©cnica: [Nome do Frame]

## Informa√ß√µes B√°sicas

- **ID Frame**: 001
- **Nome**: Login Screen
- **URL Figma**: [Link direto](https://figma.com/design/{fileKey}/{fileName}?node-id={nodeId})
- **Screenshot**: [../screens/frame-001.png](../screens/frame-001.png)
- **Dimens√µes**: 1440x900px
- **Status**: üî¥ N√£o iniciado (0%)
- **Prioridade**: Alta
- **Respons√°vel**: A definir

---

## Contexto PRISM

### M√≥dulo do Sistema
Esta interface faz parte do **m√≥dulo de Autentica√ß√£o, Identifica√ß√£o e Libera√ß√£o** do NPI, conforme documentado no TCC (Cap√≠tulo 4, Se√ß√£o 4.2).

### Fun√ß√£o no Ecossistema
O login √© o ponto de entrada para pesquisadores e profissionais de sa√∫de acessarem o IRIS. Esta tela implementa:
- Autentica√ß√£o de usu√°rios do NPI
- Controle de acesso baseado em perfis (pesquisador, m√©dico, admin)
- Integra√ß√£o com o protocolo de handshake entre n√≥s

### Padr√µes PRISM Aplic√°veis
- ‚úÖ Interface padronizada para aplica√ß√µes PRISM
- ‚úÖ Comunica√ß√£o segura com NPI backend
- ‚úÖ Registro de auditoria de acessos

---

## Elementos a Extrair

<!-- Esta se√ß√£o ser√° preenchida automaticamente na Fase 3 com dados do MCP Figma -->

### Estrutura de Componentes
*Aguardando extra√ß√£o via `Figma:get_metadata`*

### C√≥digo de Refer√™ncia
*Aguardando extra√ß√£o via `Figma:get_design_context`*

### Assets Necess√°rios
*URLs de download ser√£o gerados automaticamente*

---

## Requisitos T√©cnicos

### Frontend
- [ ] **Framework**: React 18+ com Next.js
- [ ] **Estiliza√ß√£o**: Tailwind CSS (apenas classes core)
- [ ] **Formul√°rio**: React Hook Form + Zod validation
- [ ] **Estado**: Context API ou Zustand
- [ ] **HTTP Client**: Axios com interceptors

### Responsividade
- [ ] Desktop (‚â•1440px)
- [ ] Tablet (768px - 1439px)
- [ ] Mobile (320px - 767px)

### Acessibilidade
- [ ] WCAG 2.1 n√≠vel AA
- [ ] Navega√ß√£o por teclado
- [ ] Labels ARIA apropriados
- [ ] Contraste de cores adequado

### Integra√ß√£o Backend
- [ ] Endpoint: `POST /api/v1/auth/login`
- [ ] Autentica√ß√£o JWT
- [ ] Refresh token autom√°tico
- [ ] Tratamento de erros 401/403

### Seguran√ßa
- [ ] Sanitiza√ß√£o de inputs
- [ ] Prote√ß√£o contra CSRF
- [ ] Rate limiting (client-side awareness)
- [ ] Armazenamento seguro de tokens (httpOnly cookies)

---

## Requisitos Funcionais

### RF001: Autentica√ß√£o de Usu√°rio
**Descri√ß√£o**: O sistema deve permitir que usu√°rios cadastrados fa√ßam login utilizando email e senha.

**Crit√©rios de Aceita√ß√£o**:
- [ ] Valida√ß√£o de formato de email
- [ ] Senha com m√≠nimo 8 caracteres
- [ ] Feedback visual de loading durante autentica√ß√£o
- [ ] Mensagens de erro claras e espec√≠ficas
- [ ] Redirecionamento ao dashboard ap√≥s sucesso

### RF002: Recupera√ß√£o de Senha
**Descri√ß√£o**: O sistema deve fornecer link para recupera√ß√£o de senha.

**Crit√©rios de Aceita√ß√£o**:
- [ ] Link "Esqueci minha senha" vis√≠vel
- [ ] Redirecionamento para fluxo de recupera√ß√£o

### RF003: Persist√™ncia de Sess√£o
**Descri√ß√£o**: O sistema deve lembrar usu√°rios que optarem por "Manter conectado".

**Crit√©rios de Aceita√ß√£o**:
- [ ] Checkbox "Manter conectado" funcional
- [ ] Token persistido com expira√ß√£o adequada

---

## Fluxo de Usu√°rio

```
[Usu√°rio acessa IRIS]
      ‚Üì
[Tela de Login carrega]
      ‚Üì
[Usu√°rio insere email e senha]
      ‚Üì
[Clica em "Entrar"]
      ‚Üì
[Sistema valida no NPI backend]
      ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                 ‚îÇ
[‚úÖ Sucesso]    [‚ùå Erro]
    ‚îÇ                 ‚îÇ
    ‚Üì                 ‚Üì
[Dashboard]   [Mensagem de erro]
                      ‚îÇ
                      ‚Üì
              [Usu√°rio corrige]
```

---

## Casos de Teste

### CT001: Login com credenciais v√°lidas
**Pr√©-condi√ß√µes**: Usu√°rio cadastrado no sistema  
**Passos**:
1. Acessar tela de login
2. Inserir email v√°lido
3. Inserir senha correta
4. Clicar em "Entrar"

**Resultado esperado**: Redirecionamento para dashboard principal

---

### CT002: Login com senha incorreta
**Pr√©-condi√ß√µes**: Usu√°rio cadastrado no sistema  
**Passos**:
1. Acessar tela de login
2. Inserir email v√°lido
3. Inserir senha incorreta
4. Clicar em "Entrar"

**Resultado esperado**: Mensagem "Email ou senha incorretos" sem especificar qual campo est√° errado (seguran√ßa)

---

## Notas de Implementa√ß√£o

### Considera√ß√µes de UX
- Foco autom√°tico no campo de email ao carregar
- Enter no campo de senha submete o formul√°rio
- Feedback visual de for√ßa de senha (se aplic√°vel no design)

### Considera√ß√µes de Performance
- Debounce em valida√ß√µes ass√≠ncronas (ex: verificar se email existe)
- Lazy loading de componentes pesados
- Prefetch de rotas do dashboard

### Integra√ß√µes
- Verificar disponibilidade do endpoint `/api/v1/auth/login` no NPI
- Confirmar estrutura do payload JWT
- Validar formato de mensagens de erro do backend

---

## Hist√≥rico de Altera√ß√µes

| Data       | Autor         | Descri√ß√£o                              |
|------------|---------------|----------------------------------------|
| 2025-10-17 | Claude (auto) | Frame mapeado automaticamente          |
| -          | -             | Aguardando revis√£o manual              |

---

## Pr√≥ximos Passos

- [ ] Revisar especifica√ß√£o com orientador do TCC
- [ ] Extrair componentes Figma (Fase 3)
- [ ] Implementar componente React
- [ ] Integrar com backend NPI
- [ ] Realizar testes de usabilidade
- [ ] Documentar no TCC (Cap√≠tulo 4, Se√ß√£o "Apresenta√ß√£o do Sistema")

---

## Refer√™ncias PRISM

- TCC PRISM, Cap√≠tulo 4, Se√ß√£o 4.2: "N√≥ de Pesquisa Interoper√°vel"
- `docs/architecture/node-communication.md`: Protocolo de comunica√ß√£o
- `docs/architecture/handshake-protocol.md`: Autentica√ß√£o entre n√≥s
- Normas ABNT para documenta√ß√£o de interfaces
```

---

### Fase 3: Extra√ß√£o de Design (MCP Figma)

**Entrada**: `frames-map.md` preenchido com fileKeys e nodeIds

**Processo**:
1. **Para cada frame documentado**:
   - Ler `fileKey` e `nodeId` do `frames-map.md`
   - Chamar `Figma:get_metadata` para obter estrutura hier√°rquica XML
   - Chamar `Figma:get_design_context` para c√≥digo UI e assets
   
2. **Atualizar especifica√ß√µes**:
   - Preencher se√ß√£o "Elementos a Extrair" em cada `frame-{id}-spec.md`
   - Adicionar:
     - Hierarquia de componentes identificados
     - C√≥digo de refer√™ncia (HTML/React)
     - Lista de assets com URLs de download
     - Tokens de design (cores, tipografia, espa√ßamentos)

3. **Validar cobertura**:
   - Verificar que todos os frames t√™m metadata completa
   - Identificar frames problem√°ticos (sem nodeId, erros de extra√ß√£o)
   - Gerar relat√≥rio de cobertura

**Sa√≠da**: Especifica√ß√µes completas prontas para implementa√ß√£o

---

## Formato de Comando

### Comando Principal

```bash
/mapear-frames <URL_FIGMA> [op√ß√µes]
```

### Par√¢metros

- `<URL_FIGMA>`: URL completa da p√°gina Figma (obrigat√≥rio)
- `--update-existing`: Atualiza mapeamento existente sem sobrescrever
- `--extract-design`: Executa Fase 3 automaticamente ap√≥s mapeamento
- `--filter-pattern <regex>`: Filtra frames por padr√£o de nome
- `--output-dir <path>`: Diret√≥rio customizado (padr√£o: `docs/figma/`)

### Exemplos de Uso

```bash
# Mapeamento inicial completo com extra√ß√£o de design
/mapear-frames https://figma.com/design/abc123/IRIS-UI?node-id=0:1 --extract-design

# Atualizar apenas novos frames sem sobrescrever existentes
/mapear-frames https://figma.com/design/abc123/IRIS-UI --update-existing

# Mapear apenas frames de autentica√ß√£o
/mapear-frames https://figma.com/design/abc123/IRIS-UI --filter-pattern "^(Login|Auth|Signup)"

# Mapear para diret√≥rio customizado
/mapear-frames https://figma.com/design/abc123/IRIS-UI --output-dir custom/path/figma
```

---

## Sa√≠da Esperada

### Logs Durante Execu√ß√£o

```
üé® IRIS Frame Mapper - PRISM Project
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üîç Iniciando mapeamento de frames...
üìÑ Arquivo Figma: IRIS UI Design
üÜî File Key: abc123
üåê URL: https://figma.com/design/abc123/IRIS-UI

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
FASE 1: Descoberta e Mapeamento
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üåê Abrindo p√°gina com Playwright...
‚úì P√°gina carregada com sucesso (2.3s)

üìä Descobrindo frames no canvas...
  ‚úì Frame 001: Login Screen (1440x900)
  ‚úì Frame 002: Dashboard Principal (1920x1080)
  ‚úì Frame 003: Cadastro de Pacientes (1920x1080)
  ‚úì Frame 004: Gest√£o de Acessos (1920x1080)
  ‚úì Frame 005: Visualiza√ß√£o de Biossinais (1920x1200)
  ‚úì Frame 006: Relat√≥rios (1920x1080)
  ...
  
üìä Total descoberto: 12 frames

üì∏ Capturando screenshots (resolu√ß√£o 2x)...
  ‚úì frame-001.png salvo (234 KB)
  ‚úì frame-002.png salvo (456 KB)
  ‚úì frame-003.png salvo (389 KB)
  ...
  
üì∏ 12/12 screenshots capturados

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
FASE 2: Documenta√ß√£o Estruturada
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìù Gerando frames-map.md...
‚úì √çndice geral criado (docs/figma/frames-map.md)

üìù Gerando especifica√ß√µes individuais...
  ‚úì frame-001-spec.md criado
  ‚úì frame-002-spec.md criado
  ‚úì frame-003-spec.md criado
  ...
  
üìù 12/12 especifica√ß√µes geradas

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
FASE 3: Extra√ß√£o de Design (MCP Figma)
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üé® Extraindo metadata e c√≥digo UI...
  ‚úì Frame 001: Metadata extra√≠do (45 componentes)
  ‚úì Frame 001: C√≥digo React gerado (15 KB)
  ‚úì Frame 001: 8 assets identificados
  
  ‚úì Frame 002: Metadata extra√≠do (89 componentes)
  ‚úì Frame 002: C√≥digo React gerado (32 KB)
  ‚úì Frame 002: 12 assets identificados
  ...

üé® 12/12 frames processados pelo MCP Figma

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚úÖ Mapeamento Conclu√≠do!
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìä ESTAT√çSTICAS FINAIS
  ‚Ä¢ Total de frames: 12
  ‚Ä¢ Screenshots: 12
  ‚Ä¢ Especifica√ß√µes: 12
  ‚Ä¢ Design extra√≠do: 12
  ‚Ä¢ Componentes identificados: 587
  ‚Ä¢ Assets de imagem: 95
  ‚Ä¢ Warnings: 0
  ‚Ä¢ Erros: 0

üìÇ ARQUIVOS GERADOS
  ‚Ä¢ √çndice: docs/figma/frames-map.md
  ‚Ä¢ Screenshots: docs/figma/screens/ (12 arquivos, 4.2 MB)
  ‚Ä¢ Especifica√ß√µes: docs/figma/specs/ (12 arquivos)

üìã PR√ìXIMOS PASSOS
  1. Revisar especifica√ß√µes em docs/figma/specs/
  2. Priorizar frames para desenvolvimento
  3. Atualizar status em frames-map.md conforme progresso
  4. Iniciar implementa√ß√£o React dos componentes
  5. Documentar no TCC (Cap. 4, Se√ß√£o "Apresenta√ß√£o do Sistema")

üí° COMANDOS √öTEIS
  # Ver mapa geral
  cat docs/figma/frames-map.md
  
  # Ver especifica√ß√£o de um frame
  cat docs/figma/specs/frame-001-spec.md
  
  # Verificar status do projeto
  /status-frames

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Tempo total: 45.8 segundos
```

### Relat√≥rio Final (`docs/figma/mapping-report.md`)

```markdown
# Relat√≥rio de Mapeamento - IRIS UI

**Projeto**: PRISM - Padr√£o de R√≥tulos e Interfaces para Sistemas M√©dicos  
**Componente**: IRIS (Interface de Pesquisa Interoper√°vel Segura)  
**Data**: 2025-10-17 16:45  
**Operador**: Claude CLI (automatizado)  
**Arquivo Figma**: [IRIS UI Design](https://figma.com/design/abc123/IRIS-UI)

---

## Resumo Executivo

Mapeamento automatizado completo de 12 frames da interface IRIS, gerando documenta√ß√£o estruturada conforme padr√µes do TCC e normas ABNT. Todos os frames foram identificados, capturados e especificados com sucesso, prontos para implementa√ß√£o frontend.

---

## Estat√≠sticas

### Cobertura
- ‚úÖ **Frames mapeados**: 12 de 12 (100%)
- ‚úÖ **Screenshots capturados**: 12 de 12 (100%)
- ‚úÖ **Especifica√ß√µes geradas**: 12 de 12 (100%)
- ‚úÖ **Design extra√≠do**: 12 de 12 (100%)

### Componentes Identificados
- **Total de componentes UI**: 587
- **Bot√µes**: 123
- **Inputs/Forms**: 89
- **Cards/Containers**: 145
- **√çcones**: 78
- **Tabelas**: 34
- **Gr√°ficos**: 18
- **Outros**: 100

### Assets
- **Total de imagens**: 95
- **√çcones SVG**: 67
- **Fotos/Ilustra√ß√µes**: 28
- **Tamanho total**: 12.4 MB

### Tempo de Execu√ß√£o
- **Fase 1 (Mapeamento)**: 12.3s
- **Fase 2 (Documenta√ß√£o)**: 8.7s
- **Fase 3 (Extra√ß√£o)**: 24.8s
- **Total**: 45.8s

---

## Distribui√ß√£o por M√≥dulo NPI

| M√≥dulo                        | Frames | Prioridade |
|-------------------------------|--------|------------|
| Autentica√ß√£o e Identifica√ß√£o  | 2      | Alta       |
| Dashboard/Visualiza√ß√£o        | 3      | Alta       |
| Gest√£o de Pacientes           | 2      | M√©dia      |
| Gest√£o de Acessos             | 1      | M√©dia      |
| Biossinais/Captura            | 2      | Alta       |
| Relat√≥rios                    | 2      | Baixa      |

---

## Status de Implementa√ß√£o

| Status          | Quantidade | Frames                     |
|-----------------|------------|----------------------------|
| üî¥ N√£o iniciado | 12         | Todos                      |
| üü° Em progresso | 0          | -                          |
| üü¢ Completo     | 0          | -                          |

---

## Warnings e Observa√ß√µes

Nenhum warning ou erro detectado durante o processo de mapeamento.

---

## Pr√≥ximos Passos Recomendados

### Curto Prazo (1-2 semanas)
1. **Revis√£o acad√™mica**: Validar especifica√ß√µes com orientador do TCC
2. **Prioriza√ß√£o**: Definir ordem de implementa√ß√£o dos frames
3. **Setup t√©cnico**: Configurar ambiente React/Next.js do IRIS
4. **Design system**: Extrair tokens de design (cores, tipografia, grid)

### M√©dio Prazo (3-6 semanas)
5. **Implementa√ß√£o Fase 1**: Frames de alta prioridade (Login, Dashboard)
6. **Integra√ß√£o backend**: Conectar com endpoints do NPI
7. **Testes de usabilidade**: Validar fluxos com usu√°rios piloto
8. **Documenta√ß√£o TCC**: Atualizar Cap√≠tulo 4 com telas implementadas

### Longo Prazo (7+ semanas)
9. **Implementa√ß√£o Fase 2**: Frames restantes
10. **Coleta de dados**: Realizar experimentos com sistema completo
11. **An√°lise de resultados**: Validar hip√≥teses do TCC
12. **Defesa**: Apresentar sistema funcional na banca

---

## Comandos de Manuten√ß√£o

```bash
# Verificar status atual do mapeamento
/status-frames

# Atualizar apenas frames modificados no Figma
/mapear-frames <URL> --update-existing --only-modified

# Regenerar specs mantendo anota√ß√µes manuais
/mapear-frames <URL> --preserve-notes

# Validar consist√™ncia da documenta√ß√£o
/validar-frames

# Gerar relat√≥rio de progresso de implementa√ß√£o
/progress-report
```

---

## Estrutura de Arquivos Gerada

```
docs/figma/
‚îú‚îÄ‚îÄ frames-map.md                    # √çndice geral (12 frames)
‚îú‚îÄ‚îÄ mapping-report.md                # Este relat√≥rio
‚îú‚îÄ‚îÄ screens/                         # Screenshots (4.2 MB)
‚îÇ   ‚îú‚îÄ‚îÄ frame-001.png
‚îÇ   ‚îú‚îÄ‚îÄ frame-002.png
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ specs/                           # Especifica√ß√µes detalhadas
    ‚îú‚îÄ‚îÄ frame-001-spec.md
    ‚îú‚îÄ‚îÄ frame-002-spec.md
    ‚îî‚îÄ‚îÄ ...
```

---

## Integra√ß√£o com TCC

### Refer√™ncias no Documento
- **Cap√≠tulo 4, Se√ß√£o 4.3**: Detalhar arquitetura do IRIS usando estes frames
- **Cap√≠tulo 4, Se√ß√£o "Apresenta√ß√£o do Sistema"**: Incluir screenshots como figuras
- **Cap√≠tulo 5, Experimentos**: Usar sistema implementado para coleta

### Formato de Cita√ß√£o ABNT
```latex
\begin{figure}[htpb]
\captionsetup{width=0.9\textwidth}
\caption{Tela de login do sistema IRIS.}
\label{fig:iris-login}
\includegraphics[width=0.9\textwidth]{figuras/iris/frame-001.png}
\fonte{Autoria pr√≥pria (2025)}
\end{figure}
```

---

## Observa√ß√µes Finais

- ‚úÖ Mapeamento 100% completo e validado
- ‚úÖ Documenta√ß√£o estruturada seguindo padr√µes acad√™micos
- ‚úÖ Pronto para revis√£o e implementa√ß√£o
- ‚ö†Ô∏è Revisar prioridades com orientador antes de iniciar c√≥digo
- üí° Considerar criar design system componentizado (Storybook)

---

**Gerado automaticamente por**: Claude CLI - IRIS Frame Mapper  
**Vers√£o**: 1.0.0  
**Contato**: [Inserir contato do desenvolvedor]
```

---

## Tratamento de Erros

### Cen√°rios Comuns

#### 1. URL Figma Inv√°lida
```
‚ùå ERRO: URL Figma inv√°lida

A URL fornecida n√£o corresponde ao formato esperado do Figma.

Formato esperado:
https://figma.com/design/{fileKey}/{fileName}?node-id={nodeId}

Exemplo v√°lido:
https://figma.com/design/abc123/IRIS-UI?node-id=0:1

Por favor, verifique a URL e tente novamente.
```

#### 2. Autentica√ß√£o Necess√°ria
```
‚ö†Ô∏è AVISO: Autentica√ß√£o necess√°ria

N√£o foi poss√≠vel acessar a p√°gina do Figma.
Voc√™ precisa estar logado no Figma no seu navegador.

Passos:
1. Abra https://figma.com no seu navegador
2. Fa√ßa login com sua conta
3. Execute o comando novamente

O Playwright usar√° a sess√£o ativa do seu navegador.
```

#### 3. Frame Sem Node-ID
```
‚ö†Ô∏è Frame 007 "Settings Panel" n√£o possui node-id detect√°vel
   ‚Üí Documentado sem link direto ao Figma
   ‚Üí Screenshot capturado normalmente
   ‚Üí Marcado para revis√£o manual

   Poss√≠veis causas:
   - Frame est√° em componente aninhado
   - Problema de sele√ß√£o no Playwright
   - Frame n√£o √© um top-level frame

   Solu√ß√£o: Selecione manualmente no Figma e use:
   /add-frame-manual <fileKey> <nodeId> "Nome do Frame"
```

#### 4. Timeout Playwright
```
‚ùå Erro ao capturar screenshot do Frame 012 "Report Dashboard"
   ‚Üí Timeout ap√≥s 30 segundos
   ‚Üí Tentando novamente com timeout estendido (60s)...
   
   ‚è≥ Aguarde...
   
   ‚úì Sucesso na segunda tentativa (43.2s)
```

#### 5. MCP Figma Indispon√≠vel
```
‚ö†Ô∏è MCP Figma temporariamente indispon√≠vel

   Fase 1 (Mapeamento) e Fase 2 (Documenta√ß√£o): ‚úÖ Conclu√≠das
   Fase 3 (Extra√ß√£o de design): ‚è∏Ô∏è Pendente

   Frames documentados: 12
   Screenshots capturados: 12
   Especifica√ß√µes geradas: 12
   Design extra√≠do: 0 (pendente)

   Voc√™ pode:
   1. Executar Fase 3 manualmente depois: /extrair-design
   2. Prosseguir com implementa√ß√£o usando screenshots
   3. Aguardar reconex√£o do MCP Figma

   Para tentar novamente a Fase 3:
   /mapear-frames <URL> --only-extract-design
```

---

## Integra√ß√£o com Workflow PRISM

### Contexto Acad√™mico

Este mapeamento de frames **n√£o √© apenas documenta√ß√£o t√©cnica**, mas parte fundamental do TCC:

1. **Rastreabilidade**: Cada interface IRIS implementa requisitos do PRISM
2. **Metodologia**: Processo documentado para se√ß√£o de Metodologia
3. **Resultados**: Screenshots e specs para Cap√≠tulo de Resultados
4. **Valida√ß√£o**: Sistema implementado permite experimentos pr√°ticos

### Metadados PRISM nas Specs

Cada especifica√ß√£o inclui contexto do sistema maior:

```markdown
## Contexto PRISM

### M√≥dulo do NPI
Esta interface implementa funcionalidades do m√≥dulo de [X] do N√≥ de Pesquisa Integrada.

### Padr√£o de Interface PRISM
- ‚úÖ Aplica√ß√£o (c√≠rculo): Sistema de contexto e processamento
- ‚ùå Dispositivo (losango): N√£o aplic√°vel

### Tipo de Dado Manipulado
- [ ] Biossinais (sEMG, ECG, etc.)
- [ ] Metadados de pacientes
- [ ] Registros de acesso
- [ ] Dados de auditoria

### Interoperabilidade
- **Comunica-se com**: NPI backend via REST API
- **Protocolo**: HTTPS + JWT authentication
- **Formato de dados**: JSON conforme PRISM Data Schema
- **Outros n√≥s**: N√£o se comunica diretamente (via NPI)
```

---

## Manuten√ß√£o e Atualiza√ß√£o

### Comandos de Manuten√ß√£o

```bash
# Verificar status atual de implementa√ß√£o
/status-frames
# Output: Mostra progresso de cada frame (üî¥üü°üü¢)

# Atualizar apenas frames modificados no Figma
/mapear-frames <URL> --update-existing --only-modified
# Compara timestamps e atualiza apenas o que mudou

# Adicionar frame manualmente (se Playwright falhou)
/add-frame-manual <fileKey> <nodeId> "Nome do Frame" [dimens√µes]

# Regenerar specs mantendo anota√ß√µes manuais
/mapear-frames <URL> --preserve-notes
# Preserva se√ß√µes "Notas de Implementa√ß√£o" customizadas

# Validar consist√™ncia da documenta√ß√£o
/validar-frames
# Verifica: links quebrados, screenshots faltantes, specs incompletas

# Gerar relat√≥rio de progresso
/progress-report
# Output: Markdown com % de implementa√ß√£o, pr√≥ximos passos, blockers
```

---

## Considera√ß√µes T√©cnicas

### Performance

- **Capturas paralelas**: M√°ximo 3 screenshots simult√¢neos para evitar sobrecarga
- **Cache de metadata**: Armazenar resultados do MCP Figma localmente (1h TTL)
- **Compress√£o de imagens**: PNG otimizado (pngquant) mantendo qualidade visual
- **Retry strategy**: 3 tentativas com backoff exponencial (1s, 2s, 4s)

### Qualidade

- **Screenshots**: Resolu√ß√£o 2x (Retina), formato PNG-24, max 500KB por arquivo
- **Valida√ß√£o de captures**: Verificar dimens√µes m√≠nimas (n√£o vazio/cortado)
- **Node-IDs √∫nicos**: Validar que cada nodeId aparece apenas uma vez
- **Nomenclatura**: `frame-{id:03d}` para ordena√ß√£o natural (001, 002, ..., 099)

### Extensibilidade

- **Suporte a variantes**: Estrutura preparada para dark mode, mobile, states
- **Metadata customizada**: Campos extras podem ser adicionados √†s specs
- **Formato Markdown**: Facilita versionamento Git e colabora√ß√£o
- **Export formats**: Possibilidade futura de gerar PDF, Confluence, Notion

---

## Considera√ß√µes de Seguran√ßa

- **Credenciais Figma**: Nunca logar ou armazenar credenciais no c√≥digo
- **URLs p√∫blicas**: Avisar se o arquivo Figma for p√∫blico (poss√≠vel leak de design)
- **Screenshots**: Verificar se capturas n√£o cont√™m dados sens√≠veis (LGPD)
- **Audit log**: Registrar todas as opera√ß√µes de mapeamento com timestamp

---

## Prompt de Inicializa√ß√£o para Claude CLI

Quando o usu√°rio executar o comando `/mapear-frames`, voc√™ deve responder com:

```
üé® IRIS Frame Mapper (PRISM Project)
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

Sistema de mapeamento automatizado de interfaces Figma para o projeto IRIS.

Este processo ir√°:
‚úì Mapear todos os frames da p√°gina Figma
‚úì Capturar screenshots em alta resolu√ß√£o
‚úì Gerar documenta√ß√£o estruturada (ABNT)
‚úì Extrair componentes e c√≥digo UI via MCP Figma

Por favor, forne√ßa a URL completa da p√°gina Figma do projeto IRIS.

Formato esperado:
https://figma.com/design/{fileKey}/{fileName}?node-id={nodeId}

Cole a URL abaixo:
```

Ap√≥s receber a URL, valide o formato e inicie o processo automatizado das 3 fases.

---

## Observa√ß√£o Final

Este prompt est√° otimizado para **Claude Code Desktop** com os seguintes MCPs:

- ‚úÖ **Playwright MCP**: Para navega√ß√£o e captura de screenshots
- ‚úÖ **Figma MCP**: Para extra√ß√£o de design context e metadata

**Instala√ß√£o dos MCPs**: Certifique-se de que ambos est√£o instalados e configurados corretamente antes de executar o comando.

**Localiza√ß√£o recomendada deste arquivo**: `docs/prompts/figma-frame-mapper.md` ou na raiz do projeto IRIS como `FIGMA_MAPPER_PROMPT.md`.

---

**Vers√£o**: 1.0.0  
**√öltima atualiza√ß√£o**: 2025-10-17  
**Compat√≠vel com**: Claude CLI v1.0+, Playwright MCP v1.0+, Figma MCP v1.0+  
**Projeto**: PRISM - Padr√£o de R√≥tulos e Interfaces para Sistemas M√©dicos  
**Institui√ß√£o**: UTFPR - Universidade Tecnol√≥gica Federal do Paran√°  
**Autoria**: Gerado para TCC de Engenharia de Computa√ß√£o
